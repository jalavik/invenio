{%- css url_for('workflows.static', filename='css/workflows/style.css'), '20-workflows' -%}
{% extends "workflows/hp_layout.html" %}

{% block hpbody_details %}

        <div class="well">
            <div class="muted">Workflow: <b>{{workflow.name}}</b></div>
            <span type="button" class="pull-right" style="cursor:pointer" data-toggle="collapse" data-target="#workflow-definition"><span class="caret"></span></span>
            <div id="workflow-definition" class="collapse">
                <table class="table table-striped">
                    <tbody>
                        <div class="muted"><b>Workflow Tasks:</b></div>
                        {{ utils.function_display(workflow_func, bwobject.get_extra_data()['last_task_name'], bwobject.version) }}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="well">
            <div class="muted"><b>Error Message:</b></div>
             {% if bwobject.get_extra_data()['error_msg'] != "" %}
                {{ info['last task name'] }} {{ bwobject.get_extra_data()['error_msg'] }}
                <div class="text-right">
                    <h6 id="show-more" class="text-right"><a href="#moreinfoModal" role="button" data-toggle="modal" class="float-right">Show More</a>
                    </h6>
                </div>
            {% else %}
                There were no errors.
            {% endif %}

            <div id="moreinfoModal" class="modal hide fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                <h3 id="myModalLabel">Error Log</h3>
              </div>
              <div class="modal-body">
                {% for key, value in log.iteritems() %}
                {{key}}: {{value}}
                {% endfor %}
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
              </div>
            </div>
        </div>

        <div class="well">
            <div class="muted"><b>Record Metadata</b>
                <span type="button" class="pull-right" style="cursor:pointer" data-toggle="collapse" data-target="#record-metadata-table"><span class="caret"></span></span>
            </div>
            </br>
            <div id="record-metadata-table" class="collapse">
                <table class="table table-striped">
                    <tbody>
                        <!-- {% block record_metadata_table %} -->
                        {% for key, value in info.iteritems() %}
                            <b>{{ key }}</b> = {{ value }}
                            <hr>
                        {% endfor %}

                        {% if bwobject.version == 1 %}
                            <span class="label label-success">Final</span>
                        {% elif bwobject.version == 2 %}
                            <span class="label label-warning">Halted</span>
                        {% else %}
                            <span class="label label-info">Initial</span>
                        {% endif %}
                        <!-- {% endblock record_metadata_table %} -->
                    </tbody>
                </table>
            </div>
        </div>
{% endblock %}
